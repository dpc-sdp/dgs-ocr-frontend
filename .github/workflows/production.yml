name: production

on:
  workflow_dispatch:
    inputs:
      logLevel:
        required: true
        default: 'warning'
        type: choice
        options:
        - uat
        - production

env:
  APP_RESOURCE_GROUP_NAME: "development-ocr"
  APP_RESOURCE_NAME: "devocrfront"
  IMAGE_REGISTRY_HOSTNAME: "devocrregistry.azurecr.io"
  IMAGE_NAME: "docai"
  IMAGE_TAG: "latest" 

jobs:
  print-inputs:
    runs-on: ubuntu-latest
    steps:
      - name: job summary
        run: |
          echo "### inputs" >> $GITHUB_STEP_SUMMARY
          echo "- logLevel: ${{ inputs.logLevel }}" >> $GITHUB_STEP_SUMMARY
  run:
    needs: print-inputs
    runs-on: ubuntu-latest
    environment: production
    steps:
      - run: echo ${{ inputs.logLevel }}

  # deploy:
  #   if: github.ref == 'refs/heads/master'
  #   runs-on: ubuntu-latest
  #   container:
  #     image: mcr.microsoft.com/azure-cli
  #   steps:
  #     - name: checkout
  #       uses: actions/checkout@v3
  #     - name: deploy
  #       run: |
  #         az extension add -n containerapp
  #         az login --service-principal --username ${{secrets.ARM_CLIENT_ID}} --password ${{secrets.ARM_CLIENT_SECRET}} --tenant ${{secrets.ARM_TENANT_ID}}
  #         az account set --subscription ${{secrets.ARM_SUBSCRIPTION_ID}}
  #         az containerapp update -n $APP_RESOURCE_NAME -g $APP_RESOURCE_GROUP_NAME -i $IMAGE_REGISTRY_HOSTNAME/$IMAGE_NAME:$GITHUB_SHA